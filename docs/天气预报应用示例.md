# 天气预报中的概率统计
> VSCode + Jupyter 内核运行，Markdown Preview Enhanced 秒变网页

---

## 1. 示例展示（Example Showcase）

**目标：** 30 秒肉眼实验，让用户一眼看懂「降水概率 = 生活中的确定性」

**核心交互：** 「明天会下雨吗？」+「最高温区间」双实验

功能：
1. 滑杆调气象要素（温度/湿度/风速）→ 实时刷新「降水概率」+「温度区间」
2. 下方即时画概率条 + 温度区间图
3. 一键「重复 100 次」→ 看命中频率逼近概率
4. 揭示真相：真实降水/温度落在区间的比例 vs 理论概率

💡 小提示：把湿度拖到 90 %，眼看降水概率飙到 80 %——这就是生活中的 LLN！

---

## 2. 理论探索（Theoretical Exploration）

**标题：** 3 步拆解生活中的概率——从直觉到公式

---

### 知识点 1/3：降水概率 —— Bernoulli → Logistic

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **Bernoulli 试验**：只有「成功/失败」两种结果的随机试验
- **Logistic 函数**：S 形曲线，将任意实数映射到 (0,1) 概率
- **似然函数**：给定参数时，观测到样本的概率
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：写似然  
P(雨|x) = π(x) = 1/(1+e^-(β₀+β₁T+β₂RH+β₃U))

步骤 2：取对数  
ℓ(β) = Σ[yᵢlogπ(xᵢ) + (1-yᵢ)log(1-π(xᵢ))]

步骤 3：求极值 → MLE  
dℓ/dβ = 0 → 解出 β̂_MLE
</details>

#### ② 趣味性可视化
- 左侧滑杆调 T/RH/U → 右侧实时画 S 形曲线，看 π 随 RH 陡峭上升
- 点击「生成 1000 次」→ 机器疯狂投币，频率柱逼近 π

<!-- 解锁网关 -->
<div class="unlock-gate" data-step="1">
  <p>你对「降水概率模型」的理解程度？</p>
  <button class="rate-btn" data-val="1">1 完全不懂</button>
  <button class="rate-btn" data-val="2">2</button>
  <button class="rate-btn" data-val="3">3 似懂非懂</button>
  <button class="rate-btn" data-val="4">4</button>
  <button class="rate-btn" data-val="5">5 完全理解</button>

  <div class="ai-help" style="display:none;">
    <hr/>
    <b>🤖 AI 解说</b>：<br/>
    把大气想成巨大骰子：湿度=骰子权重，>90 % 时「雨面」变重，所以概率陡升。
    <br/><button class="unlock-next">我理解了</button>
  </div>
</div>

---

### 知识点 2/3：温度区间 —— 分位数回归

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **分位数回归**：估计任意分位点，不给单点给区间
- **10 %-90 % 区间**：大概率范围，宽度 ∝ 1/√n
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：写分位数损失  
ρ_τ(u) = u(τ − I[u<0])

步骤 2：最小化  
Q_τ(y|x) = argmin_β Σρ_τ(yᵢ − xᵢᵀβ)

步骤 3：解线性规划 → 得到上下界
</details>

#### ② 趣味性可视化
- 滑块调 T₈₅₀ → 实时看区间上下边界「剪刀」开合，宽度 ∝ 1/√n
- 点击「加速到 n=1000」→ 区间变窄，肉眼验证「精度=1/√n」

<!-- 解锁网关 2 -->
<div class="unlock-gate" data-step="2">
  ...
  <div class="ai-help" style="display:none;">
    <b>🤖 AI 解说</b>：<br/>
    想精度提高 10 倍？样本量要翻 100 倍！就像擦玻璃——抹布面积平方级加大。
    <br/><button class="unlock-next">我理解了</button>
  </div>
</div>

---

### 知识点 3/3：命中检验 —— 概率 vs 频率

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **Brier 分数**：(1/N) Σ(p_i − y_i)²，越低越准
- **可靠性曲线**：频率 vs 预测概率的散点图
- **校准**：预测概率 ≈ 长期频率
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：收集预测概率 p_i 和真实标签 y_i  
步骤 2：按概率分箱，计算每箱频率  
步骤 3：画可靠性曲线，理想 = 对角线
</details>

#### ② 趣味性可视化
- 一键「重复 1000 次」→ 实时画可靠性曲线，看 70 % 概率≈70 次命中
- 点击「导出 CSV」→ 自己算 Brier

<!-- 解锁网关 3 -->
<div class="unlock-gate" data-step="3">
  ...
  <div class="ai-help" style="display:none;">
    <b>🤖 AI 解说</b>：<br/>
    概率不是「猜」，而是「长期命中率」。投 1000 次，70 % 概率≈700 次命中——这就是 LLN 的肉眼版。
    <br/><button class="unlock-next">我理解了</button>
  </div>
</div>

---

## 3. 实践应用（Practical Applications）

> 每个应用 =「分步引导 + 核心知识点 + 小测试」  
> 必须逐步点击「已完成」才能解锁下一步；全部完成后弹出「知识点考察」。

---

### 应用一：智能雨伞提醒（降水概率决策）

#### 第①步：进入场景
功能：
1. 播放 5 秒动画：手机推送「降水概率 70 %」→ 用户犹豫是否带伞  
2. 核心知识点卡片：「Bernoulli + Logistic = 生活决策」  
3. 点击「我已了解」→ 解锁第②步

#### 第②步：设置参数
功能：
1. 滑杆调 T/RH/U（实时读到网页）  
2. 实时显示「降水概率」数值条  
3. 点击「参数已设定」→ 解锁第③步

#### 第③步：运行决策
功能：
1. 点击「生成明天」→ 系统随机生成真实降水（0/1）  
2. 若概率≥70 % 且真实=1 → 绿灯「带伞正确」  
3. 否则红灯「白带/淋雨」  
4. 点击「运行完成」→ 解锁第④步

#### 第④步：对比实验
功能：
1. 一键「把阈值降到 40 %」→ 再次运行 100 天  
2. 统计「淋雨次数」&「白带次数」  
3. 弹出结论卡片：「阈值↓→淋雨↓但白带↑」  
4. 点击「对比完成」→ 弹出「知识点考察」

<!-- === 应用通关网关=== -->
<div class="app-gate" data-app="1">
  <button class="exam-btn">开始知识点考察（3 题）</button>
  <div class="exam-paper" style="display:none;">
    <ol>
      <li>单选：降水概率与哪项成正比？
        <br/><label><input type="radio" name="q1" value="A"> A. 1/n</label>
        <br/><label><input type="radio" name="q1" value="B"> B. 1/√n</label>
        <br/><label><input type="radio" name="q1" value="C"> C. 湿度</label>
      </li>
      <li>判断：阈值 70 % 意味着 100 天中约有 70 次会降水。（√）</li>
      <li>单选：降低阈值会导致？
        <br/><label><input type="radio" name="q3" value="A"> A. 淋雨↓白带↑</label>
        <br/><label><input type="radio" name="q3" value="B"> B. 淋雨↑白带↓</label>
        <br/><label><input type="radio" name="q3" value="C"> C. 无变化</label>
      </li>
    </ol>
  <button class="submit-exam">提交</button>
  <div class="exam-result" style="display:none;"></div>
</div>
</div>

<script>
/* ========= 应用通关逻辑 ========= */
document.querySelector('.exam-btn').addEventListener('click',e=>{
  document.querySelector('.exam-paper').style.display='block';
});
document.querySelector('.submit-exam').addEventListener('click',e=>{
  const ans=['C','√','A']; // 标准答案
  let score=0;
  ans.forEach((a,i)=>{
    const user=document.querySelector(`input[name="q${i+1}"]:checked`)?.value;
    if(user===a) score++;
  });
  const pass=score>=2; // ≥2 分通关
  document.querySelector('.exam-result').innerHTML=
    `${pass?'✅ 通关':'❌ 未通关'} 得分：${score}/3  
     <button onclick="location.reload()">${pass?'进入下一应用':'重考'}</button>`;
  document.querySelector('.exam-result').style.display='block';
});
</script>

---

## 4. 章节练习（Chapter Exercises）

**Level 1 基础概念**  
功能：  
1. 降水概率 70 % 意味着 100 天中约有几次降水？（70 次）  
2. 判断：增大样本量 n 会使温度区间变窄。（√）  

**Level 2 计算与解读**  
功能：  
1. 给定 30 个观测值，手动计算 80 % 温度区间（分位数回归）  
2. 若总体方差未知，改用 t 分布再算一次，比较宽度变化  

**Level 3 分析与设计**  
功能：  
1. 设计一个「估计直播间真实在线人数」的抽样方案，说明如何选 n、如何控制成本  
2. 如果总体服从 Cauchy(α=1) 期望无限，给出两条替代估计策略（提示：中位数、截尾均值）  

---

## 5. 网页内容设计概要（UI/UX）

- **顶部：** 标题「天气预报中的概率统计」+ 一句 slogan「用概率看懂天气」  
- **左侧：** 固定导航栏，直接链接到【示例】【理论】【应用】【练习】四个部分  
- **布局：**  
  - 【示例】部分：双滑杆占首屏 70 %，按钮悬浮底部，不打断动画  
  - 【理论】部分：3 张可折叠卡片，每卡右侧留 15 % 宽度给「AI 助手」与「解锁按钮」  
  - 【应用】部分：分步卡片，必须点击「已完成」才能解锁下一步；全部完成后弹出「知识点考察」  
  - 【练习】部分：题目默认折叠，答题后展开解析与知识点回链  
- **视觉：** 主色 #FF6B6B（概率条），辅助灰 #E0E0E0（区间带），所有轨迹默认半透明 0.6  
