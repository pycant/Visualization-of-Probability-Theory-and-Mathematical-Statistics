# 示例展示
1. 离散型场景：抛硬币是否均匀
   -我们想检验一枚硬币是否均匀（即正面朝上的概率是否为0.5）。
    - 功能：
         1. 模拟抛硬币过程，可自由选择抛的次数（如10次、100次、1000次），实时显示正面/反面次数。
         2. 若抛100次时正面次数严重偏离50（如<30或>70），触发“偏离显著”动画，用颜色闪烁突出结果。
         3. 一键启动“100组×100次抛硬币”实验，动态展示每组正面次数的分布直方图，并叠加理论二项分布 \( B(100, 0.5) \) 的密度曲线，直观对比实际与理论分布。
         4. 调整硬币“真实偏向”（如设 \( p = 0.6 \)），观察随着实验次数增加，“拒绝‘硬币均匀’假设”的频率如何从低到高变化，感受“检验功效”的提升。
2. 连续型场景：饮料瓶容量的正态检验
   -某工厂生产的饮料瓶标注容量为500ml，假设容量服从正态分布 \( N(\mu, \sigma^2) \)，需检验是否符合标注（\( \mu = 500 \)）。
    - 功能：
         1. 模拟从正态总体抽样，可交互调整总体均值 \( \mu \)、标准差 \( \sigma \) 和样本量 \( n \)，生成模拟样本数据。
         2. 自动计算样本均值 \( \bar{x} \)、样本标准差 \( s \)，根据“\( \sigma \) 已知/未知”选择Z检验或t检验，绘制检验统计量的理论分布（如t分布曲线），并标记统计量的实际值在分布中的位置。
         3. 滑动条调整显著性水平 \( \alpha \)（如0.01、0.05、0.1），实时显示拒绝域的范围变化，以及临界值的数值变化。
         4. 固定 \( \alpha = 0.05 \)，设置实际均值 \( \mu = 505 \)（与标注有差异），观察不同样本量 \( n \) 下，“检测出容量不合格（拒绝 \( H_0 \)）”的频率变化，理解“样本量越大，检验功效越高”。
3. A/B测试场景：按钮颜色对转化率的影响
   -某电商平台测试“加入购物车”按钮颜色对转化率的影响，验证新版本是否优于旧版本：
    -版本A（对照组）：蓝色按钮，1000次访问中50次成功加入购物车（转化率5%）。
    -版本B（实验组）：红色按钮，1000次访问中70次成功加入购物车（转化率7%）。
    - 功能：
        - 动态调整样本量（如500/1000/5000次访问），观察转化率差异的统计显著性变化。
        - 可视化展示两版本转化率的置信区间，若区间无重叠则提示“可能存在显著差异”。
        - 模拟1000次重复实验，展示“当两版本无差异时，出现当前差异”的概率（P值），直观解释统计显著性。
        - 提供“最小样本量计算器”，输入预期转化率差异、\( \alpha \) 和检验功效，自动计算所需样本量。




# 理论探索
- 重点理论
  - 假设相关
    - 统计假设：参数空间\(\Theta = \{\theta\}\)的非空子集，或有关参数\(\theta\)的命题，简称“假设”
    - 原假设：根据需要设立的假设，常记为\(H_0: \theta \in \Theta_0\)
    - 备择假设：原假设被拒绝后采用的假设，常记为\(H_1: \theta \in \Theta_1\)
    - 约束条件：\(\Theta_0 \cap \Theta_1 = \varnothing\)（原假设与备择假设不含公共参数）
    - 简单假设与复杂假设：若\(H_0\)（或\(H_1\)）只含一个参数点，称为简单假设；否则称为复杂假设
  - 检验法则
    - 定义：对原假设\(H_0: \theta \in \Theta_0\)，作出“是否拒绝\(H_0\)”的判断法则，简称“检验”
    - 检验结果
      - 拒绝原假设：原假设不正确，称为“检验显著”
      - 接受原假设：原假设正确，称为“检验不显著”
    - 核心特点：着力点在于说明“原假设不正确”（用样本推翻原假设更合理），因此重点建立“拒绝域”
  - 检验问题分类
    - 检验问题：由原假设\(H_0\)和备择假设\(H_1\)组成的、需要判断的问题
    - 参数假设检验：两个假设均为“有关参数的命题”
    - 非参数假设检验：两个假设均为“有关分布的命题”
    - 常用参数检验形式（\(\theta_0\)为已知常数）
      - 单侧检验（形式1）：\(H_0: \theta \leq \theta_0\) vs \(H_1: \theta > \theta_0\)
      - 单侧检验（形式2）：\(H_0: \theta \geq \theta_0\) vs \(H_1: \theta < \theta_0\)
      - 双侧检验：\(H_0: \theta = \theta_0\) vs \(H_1: \theta \neq \theta_0\)
  - 两类错误
    - 第一类错误：原假设\(H_0\)正确，但被拒绝（“拒真错误”），发生概率记为\(\alpha\)
    - 第二类错误：原假设\(H_0\)不真，但被接受（“取伪错误”），发生概率记为\(\beta\)
  - 假设检验的基本步骤
    - 步骤1：建立假设（确定原假设\(H_0\)和备择假设\(H_1\)）
    - 步骤2：选择检验统计量，给出拒绝域\(W\)的形式
      - 检验统计量：用于对“原假设\(H_0\)是否成立”作判断的统计量
      - 拒绝域：使“原假设\(H_0\)被拒绝”的样本观测值所在区域（记为\(W\)）
    - 步骤3：选择显著性水平\(\alpha\)（选取\(0 < \alpha < 1\)的常数）
    - 步骤4：确定具体拒绝域（由概率等式\(P(W) = \alpha\)推导拒绝域\(W\)的具体形式）
    - 步骤5：作出判断
      - 若样本\((x_1, x_2, \dots, x_n) \in W\)：拒绝原假设\(H_0\)
      - 若样本\((x_1, x_2, \dots, x_n) \notin W\)：接受原假设\(H_0\)
  - 势函数
    - 定义：对检验问题\(H_0: \theta \in \Theta_0\) vs \(H_1: \theta \in \Theta_1\)，若拒绝域为\(W\)，则“样本观测值\((x_1, x_2, \dots, x_n)\)落在\(W\)内的概率”称为势函数，记为：
      \[
      g(\theta) = P_\theta\{(x_1, x_2, \dots, x_n) \in W\}, \quad \theta \in \Theta_0 \cup \Theta_1
      \]
    - 与两类错误概率的关系：
      \[
      g(\theta) = 
      \begin{cases} 
      \alpha(\theta), & \theta \in \Theta_0, \\
      1 - \beta(\theta), & \theta \in \Theta_1.
      \end{cases}
      \]
  - 水平为\(\alpha\)的检验
    - 定义：若一个检验“犯第一类错误的概率”\(\alpha(\theta)\)满足：对所有\(\theta \in \Theta_0\)，都有\(\alpha(\theta) \leq \alpha\)（\(\alpha\)为事先给定的显著性水平），则称该检验为“显著性水平为\(\alpha\)的显著性检验”
    - \(\alpha\)的选择：不宜过小（否则“犯第二类错误的概率\(\beta\)”会过大），常用取值为\(\alpha = 0.05\)、\(\alpha = 0.10\)、\(\alpha = 0.01\)
  - 检验的\(p\)值
    - 定义：在某一假设检验问题中，利用“样本观察值”能作出“拒绝原假设\(H_0\)”的最小显著性水平，称为该检验的\(p\)值
    - 好处
      - 客观性：避免了“事先主观确定显著性水平\(\alpha\)”的问题
      - 便于判断：将\(p\)值与“心目中的显著性水平\(\alpha\)”比较
        - 若\(\alpha \geq p\)：在显著性水平\(\alpha\)下，拒绝原假设\(H_0\)
        - 若\(\alpha < p\)：在显著性水平\(\alpha\)下，接受原假设\(H_0\)
      - 计算便捷：统计软件可直接计算\(p\)值，无需备用“各类抽样分布的分位数表”
- 重要结论
  - 原假设与备择假设的“非对称性”：假设检验更关注“推翻原假设”，而非“证明原假设正确”
  - 拒绝域与检验法则的一一对应性：一个拒绝域唯一确定一个检验法则
  - 势函数的“功效”意义：势函数\(g(\theta)\)反映检验对“备择假设”的识别能力（\(1 - \beta\)越大，检验功效越强）
- 公式推理
  - 势函数的表达式推导：基于“样本落在拒绝域的概率”的定义，结合“第一类错误概率\(\alpha(\theta)\)”和“第二类错误概率\(\beta(\theta)\)”的关系，推导得势函数与两类错误概率的关联式
  - 水平\(\alpha\)检验的概率约束推导：由于“犯第一类错误的概率”\(\alpha(\theta) = g(\theta)\)（当\(\theta \in \Theta_0\)时），因此要求“对所有\(\theta \in \Theta_0\)，\(g(\theta) \leq \alpha\)”，以此定义水平为\(\alpha\)的检验




# 实践应用
1. 单样本t检验实操（基础案例）
   -问题：某班学生数学成绩服从正态分布，随机抽10名学生成绩：78, 85, 68, 90, 82, 75, 80, 83, 79, 81。检验平均成绩是否为80分（\( \alpha = 0.05 \)）。
      - 步骤：
          1. 建立假设：\( H_0: \mu = 80 \)；\( H_1: \mu \neq 80 \)（双侧检验）。
          2. 选择统计量：\( \sigma^2 \) 未知，用t检验，统计量 \( t = \frac{\bar{X} - 80}{S / \sqrt{10}} \sim t(9) \)。
          3. 拒绝域：\( |t| \geq t_{0.025}(9) = 2.2622 \)。
          4. 计算：\( \bar{X} = 80.1 \)，\( S \approx 4.037 \)，\( t \approx 0.078 \)。
          5. 决策：\( |t| < 2.2622 \)，不拒绝 \( H_0 \)，无足够证据认为平均成绩不是80分。
2. A/B测试中的比例检验实操（电商案例）
   -问题：验证红色按钮（B）转化率是否高于蓝色按钮（A）：\( n_A=1000, x_A=50 \)；\( n_B=1000, x_B=70 \)（\( \alpha=0.05 \)）。
      - 步骤：
          1. 建立假设：\( H_0: p_A = p_B \)；\( H_1: p_B > p_A \)（单侧检验）。
          2. 选择统计量：大样本比例检验，用Z统计量：
        \[
          Z = \frac{(\hat{p}_B - \hat{p}_A)}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{n_A} + \frac{1}{n_B})}} \sim N(0,1)
        \]
          3. 拒绝域：\( Z \geq Z_{0.05} = 1.645 \)。
          4. 计算：
        - \( \hat{p}_A=0.05 \)，\( \hat{p}_B=0.07 \)，合并转化率 \( \hat{p}=0.06 \)，
        - \( Z \approx \frac{0.02}{\sqrt{0.06 \times 0.94 \times 0.002}} \approx 1.887 \)。
          5. 决策：\( Z > 1.645 \)，拒绝 \( H_0 \)，可认为红色按钮转化率显著更高。
3. 模拟实验：A/B测试样本量影响
    -用Python模拟“两版本无差异（\( p_A=p_B=0.05 \)）但样本量不同”的场景：
       - 当样本量=100时，随机波动可能导致转化率差异达2%，但P值常>0.05（不显著）。
       - 当样本量=10000时，相同差异的P值<0.05（易显著），说明“大样本更易检测微小差异”。





# 章节练习
- 一、单个正态总体均值的\(u\)检验（方差已知）
  -例题1：某厂生产的某种零件，其长度服从正态分布\(N(\mu, 0.09)\)，现从某日生产的一批零件中随机抽取9个，测得其平均长度为\(21.4\)cm。已知该零件标准长度为\(21\)cm，问该日生产的零件长度是否显著偏离标准？（显著性水平\(\alpha = 0.05\)）
     - 解题步骤：
      1. 建立假设：
        双侧检验：\(H_0: \mu = 21\) vs \(H_1: \mu \neq 21\)
      2. 选择检验统计量：
        由于\(\sigma^2 = 0.09\)已知，检验统计量为：
       \[
        U = \frac{\bar{X} - \mu_0}{\sigma / \sqrt{n}} \sim N(0, 1) \quad (H_0\text{为真时})
       \]
      3. 确定拒绝域：
        显著性水平\(\alpha = 0.05\)，双侧检验的拒绝域为\(|U| \geq u_{1 - \alpha/2}\)。查标准正态分布表得\(u_{0.975} = 1.96\)，因此拒绝域为\(|U| \geq 1.96\)。
      4. 计算检验统计量观测值：
        已知\(\bar{x} = 21.4\)，\(\mu_0 = 21\)，\(\sigma = 0.3\)，\(n = 9\)，代入得：
      \[
       U = \frac{21.4 - 21}{0.3 / \sqrt{9}} = \frac{0.4}{0.1} = 4
      \]
      5. 作出判断：
        由于\(|U| = 4 > 1.96\)，落在拒绝域内，因此拒绝原假设\(H_0\)，即认为该日生产的零件长度显著偏离标准。
- 二、单个正态总体均值的\(t\)检验（方差未知）
  -例题2：某种电子元件的寿命（单位：小时）服从正态分布，现从一批元件中随机抽取16个，测得其寿命均值\(\bar{x} = 1900\)，样本标准差\(s = 400\)。已知该类元件的标准寿命为2000小时，问这批元件的寿命是否显著低于标准？（显著性水平\(\alpha = 0.05\)）
     - 解题步骤：
      1. 建立假设：
        单侧检验（左侧）：\(H_0: \mu \geq 2000\) vs \(H_1: \mu < 2000\)
      2. 选择检验统计量：
       由于\(\sigma^2\)未知，检验统计量为：
       \[
       T = \frac{\bar{X} - \mu_0}{S / \sqrt{n}} \sim t(n-1) \quad (H_0\text{为真时})
       \]
      3. 确定拒绝域：
       显著性水平\(\alpha = 0.05\)，自由度\(n-1 = 15\)，查\(t\)分布表得\(t_{0.05}(15) = 1.7531\)，左侧检验的拒绝域为\(T \leq -t_{0.05}(15)\)，即\(T \leq -1.7531\)。
       4. 计算检验统计量观测值：
       已知\(\bar{x} = 1900\)，\(\mu_0 = 2000\)，\(s = 400\)，\(n = 16\)，代入得：
       \[
       T = \frac{1900 - 2000}{400 / \sqrt{16}} = \frac{-100}{100} = -1
       \]
       5. 作出判断：
       由于\(T = -1 > -1.7531\)，未落在拒绝域内，因此接受原假设\(H_0\)，即认为这批元件的寿命未显著低于标准。
- 三、单个正态总体方差的\(\chi^2\)检验
  -例题3：某厂生产的钢丝，其断裂强度服从正态分布。现从一批钢丝中随机抽取9根，测得断裂强度的样本方差\(s^2 = 100\)（单位：\(kg/cm^2\)）。已知该类钢丝断裂强度的方差标准值为\(80\)，问这批钢丝的断裂强度方差是否显著偏大？（显著性水平\(\alpha = 0.05\)）
     - 解题步骤：
      1. 建立假设：
      单侧检验（右侧）：\(H_0: \sigma^2 \leq 80\) vs \(H_1: \sigma^2 > 80\)
      2. 选择检验统计量：
      检验统计量为：
      \[
      \chi^2 = \frac{(n-1)S^2}{\sigma_0^2} \sim \chi^2(n-1) \quad (H_0\text{为真时})
      \]
      3. 确定拒绝域：
      显著性水平\(\alpha = 0.05\)，自由度\(n-1 = 8\)，查\(\chi^2\)分布表得\(\chi^2_{0.05}(8) = 15.507\)，右侧检验的拒绝域为\(\chi^2 \geq 15.507\)。
      4. 计算检验统计量观测值：
      已知\(n = 9\)，\(s^2 = 100\)，\(\sigma_0^2 = 80\)，代入得：
      \[
      \chi^2 = \frac{(9-1) \times 100}{80} = \frac{800}{80} = 10
      \]
      5. 作出判断：
      由于\(\chi^2 = 10 < 15.507\)，未落在拒绝域内，因此接受原假设\(H_0\)，即认为这批钢丝的断裂强度方差未显著偏大。
- 四、两个正态总体均值差的\(t\)检验（方差相等且未知）
 -例题：为比较两种型号灯泡的寿命，随机抽取A型灯泡10只，测得平均寿命\(\bar{x} = 1200\)小时，样本标准差\(s_1 = 50\)小时；抽取B型灯泡8只，测得平均寿命\(\bar{y} = 1150\)小时，样本标准差\(s_2 = 60\)小时。假设两种灯泡寿命均服从正态分布且方差相等，问A型灯泡寿命是否显著高于B型？（显著性水平\(\alpha = 0.05\)）
     - 解题步骤：
      1. 建立假设：
      单侧检验（右侧）：\(H_0: \mu_1 - \mu_2 \leq 0\) vs \(H_1: \mu_1 - \mu_2 > 0\)
      2. 选择检验统计量：
      由于方差相等且未知，检验统计量为：
      \[
      T = \frac{(\bar{X} - \bar{Y}) - \delta}{S_w \sqrt{\frac{1}{n} + \frac{1}{m}}} \sim t(n+m-2)
      \]
      其中\(S_w^2 = \frac{(n-1)S_1^2 + (m-1)S_2^2}{n+m-2}\)，\(\delta = 0\)，\(n = 10\)，\(m = 8\)。
      3. 计算合并方差\(S_w^2\)：
      \[
      S_w^2 = \frac{(10-1) \times 50^2 + (8-1) \times 60^2}{10+8-2} = \frac{9 \times 2500 + 7 \times 3600}{16} = \frac{22500 + 25200}{16} = \frac{47700}{16} = 2981.25
      \]
      \(S_w = \sqrt{2981.25} \approx 54.6\)
      4. 确定拒绝域：
      自由度\(n+m-2 = 16\)，查\(t\)分布表得\(t_{0.05}(16) = 1.7459\)，右侧检验的拒绝域为\(T \geq 1.7459\)。
      5. 计算检验统计量观测值：
     \[
      T = \frac{(1200 - 1150) - 0}{54.6 \times \sqrt{\frac{1}{10} + \frac{1}{8}}} = \frac{50}{54.6 \times \sqrt{0.225}} \approx \frac{50}{54.6 \times 0.474} \approx \frac{50}{25.88} \approx 1.93
      \]
      6. 作出判断：
      由于\(T = 1.93 > 1.7459\)，落在拒绝域内，因此拒绝原假设\(H_0\)，即认为A型灯泡寿命显著高于B型。
- 五、两个正态总体方差比的\(F\)检验
 -例题：为比较两种工艺生产的零件尺寸稳定性，随机抽取工艺1生产的零件10个，样本方差\(s_1^2 = 2.25\)；工艺2生产的零件8个，样本方差\(s_2^2 = 4.41\)。假设零件尺寸服从正态分布，问工艺1的方差是否显著小于工艺2的方差？（显著性水平\(\alpha = 0.05\)）
     - 解题步骤：
      1. 建立假设：
      单侧检验（左侧）：\(H_0: \sigma_1^2 / \sigma_2^2 \geq 1\) vs \(H_1: \sigma_1^2 / \sigma_2^2 < 1\)
      2. 选择检验统计量：
      检验统计量为：
      \[
      F = \frac{S_1^2}{S_2^2} \sim F(n-1, m-1) \quad (H_0\text{为真时})
      \]
      其中\(n = 10\)，\(m = 8\)。
      3. 确定拒绝域：
      显著性水平\(\alpha = 0.05\)，自由度\((n-1, m-1) = (9, 7)\)，查\(F\)分布表得\(F_{0.95}(9, 7) = \frac{1}{F_{0.05}(7, 9)} \approx \frac{1}{3.29} \approx 0.304\)（左侧检验的拒绝域为\(F \leq F_{1-\alpha}(n-1, m-1)\)）。
      4. 计算检验统计量观测值：
      \[
       F = \frac{2.25}{4.41} \approx 0.510
      \]
      5. 作出判断：
      由于\(F = 0.510 > 0.304\)，未落在拒绝域内，因此接受原假设\(H_0\)，即认为工艺1的方差未显著小于工艺2的方差。



   
# 工具
-同学常见不足及提升建议
1.A/B测试样本量估算错误：
   - 不足：忽视样本量对检验功效的影响，导致“实际有差异却检测不出”。
   - 工具：
     - 在线计算器：[VWO样本量计算器](https://vwo.com/tools/sample-size-calculator/)，输入基准转化率、预期提升值即可计算所需样本量。
     - 练习：用不同参数（如转化率5%→6% vs 5%→8%）对比样本量差异，理解“差异越小，所需样本量越大”。
2. 比例检验与均值检验混淆：
   - 不足：在A/B测试中对“转化率（比例）”错用t检验，而非Z检验。
   - 工具：
     - 统计软件：用Python `statsmodels` 的 `proportions_ztest` 函数，对比手动计算结果。
     - 流程图：制作“指标类型→检验方法”决策树（如“比例→Z检验；均值→t检验/Z检验”）。
3. 多重比较导致第一类错误膨胀：
   - 不足：同时测试多个版本（如红/绿/黄3种按钮）时，未修正 \( \alpha \)，增加误判风险。
   - 工具：
     - 校正方法：采用Bonferroni校正（将 \( \alpha \) 除以测试组数），用[在线校正工具](https://www.socscistatistics.com/pvalues/bonferronicorrection.aspx)验证。
     - 案例分析：模拟10次无差异的A/B测试，观察“不校正时错误显著的概率”（约40%）。
4. 混淆统计显著性与实际意义：
   - 不足：认为“统计显著即必须上线”，忽视微小差异的业务价值（如转化率提升0.1%）。
   - 工具：
     - 业务计算器：输入“日均访问量、客单价”，计算转化率提升的实际收益（如[转化价值计算器](https://www.smartinsights.com/conversion-rate-optimization/cro-calculator/)）。
     - 阈值设定：结合成本制定“最小有意义差异”（如提升≥1%才值得上线）。