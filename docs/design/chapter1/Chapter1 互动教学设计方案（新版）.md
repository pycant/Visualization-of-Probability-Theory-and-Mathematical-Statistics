## 目标

- 围绕《目录.md》第一章按目录顺序设计互动案例，增强直觉与可玩性。
- 保持页面/脚本风格一致，使用 KaTeX 与轻量图形；落地到 `templates/chapter1.html` 与 `static/js/chapter1.js`。

## 1.1 随机事件及其运算｜事件运算可视化沙盒

- 教学目标：直观理解并集（∪）、交集（∩）、补集（¯）与包含关系；连接样本空间与事件域。
- 玩法：两类事件占比用滑块设定，动态韦恩图显示 `P(A∪B)`、`P(A∩B)`、`P(A¯)`；标签可切换为“吃瓜/发弹幕”“点赞/收藏”。

### 设计细节

- 控件：`P(A)`、`P(B)`、`P(A∩B)` 三滑块，强制约束 `0 ≤ P(A∩B) ≤ min(P(A), P(B))`。
- 模式：`独立`/`相关` 切换；独立时自动设定 `P(A∩B)=P(A)P(B)`，相关时由用户指定。
- 计算：实时显示 `P(A∪B)=P(A)+P(B)-P(A∩B)`、`P(A¯)=1-P(A)`、`P(B¯)=1-P(B)`，用 KaTeX 渲染。
- 可视化：SVG 双圆韦恩图，面积比例近似到半径缩放；重叠区高亮，鼠标悬停显示数值提示。
- 无障碍：为滑块与图形添加 `aria-label` 与数值标签，颜色遵循霓虹高对比但文字保持可读。

### 历史介绍

- 韦恩图由约翰·韦恩（John Venn, 1880）提出，用于集合关系可视化。
- 概率的集合化与公理化在 20 世纪由科尔莫哥洛夫（Kolmogorov, 1933）系统化，基于集合与测度的形式化定义。

## 1.2 概率的定义及其确定方法｜骰子到暴击（古典样本空间 → 频率法）

- 教学目标：从等可能样本空间理解概率，连接到游戏暴击率/连击；频率法收敛与理论值对照。
- 玩法：设定暴击率与攻击次数，展示命中分布与 `P(≥1)=1-(1-p)^n`；提示“独立同分布前提”。

### 设计细节

- 控件：`p`（暴击率）、`n`（攻击次数）、一次试验与批量试验按钮（100/1000 次）。
- 统计：显示理论值 `P(≥1)` 与频率估计，误差条与收敛曲线；必要时用轻量柱状图。
- 样本空间：提供骰子等可能示例（古典法）与 Bernoulli 独立试验（频率法）对照说明。
- 提示：标注独立同分布（i.i.d.）前提，避免误用频率法在依赖情形。
- 可以添加仪表盘，展示实验结果与收敛趋势。
- 可以添加实验参数调整面板，如改变暴击率、攻击次数、抽卡次数等。

### 历史介绍

- 古典概率由拉普拉斯（Laplace, 1812）系统阐述，基于等可能样本空间。
- 频率法由伯努利（Jakob Bernoulli, 1713）的大数定律奠基，说明频率向理论概率收敛。

## 1.3 概率的性质｜抽卡/盲盒概率实验台（含保底与补事件）

- 教学目标：用加法与补事件解释基本性质；观察保底规则对概率的影响。
- 玩法：
  - 自设稀有/常规掉率与保底规则；连续抽 N 次，显示稀有命中率与频率收敛曲线。
  - 补事件：`1-(1-p)^n`（独立同分布前提）；保底示例模型（递增保底 `p(n)=min(p0+α·max(n-k,0), p_max)` 或第 `k` 抽必定命中）。
  - 消费梗：单抽默认 `¥16`（可调），累计金额档位展示；如“已消耗 ¥168 ≈ 某热门作品周边”；幸运度标签“非酋/终极大非酋/欧皇/万里挑一的欧皇”等可配置。
- 展示：三栏布局（左参数/中演示/右讲解面板公式+视频切换）；移动端上下布局、讲解面板折叠。
- 功能框组件：讲解面板使用“公式/代码功能框”（复制 Markdown/LaTeX、视图切换），接口 `initFormulaBox(el, { latex, code, defaultView: 'latex' })`。

### 设计细节

- 保底模型：支持“递增保底”“截断几何”（第 k 抽必中）两种；参数 `p0, α, k, p_max` 可调。
- 统计：显示理论命中概率、期望抽数、成本估计；频率曲线与理论曲线对比。
- 标签：幸运度分级根据累计命中/失败情况动态赋值；支持自定义文案以贴近文化语境。
- 性能：批量试验使用渐进渲染与节流，避免卡顿；移动端简化动画。

### 历史介绍

- “扭蛋/抽卡”源于日本的胶囊玩具文化，现代手游引入“保底”以缓解极端不幸体验（如钓鱼空军送鸡、夹娃娃送爆米花）。
- 概率中的补事件与加法公式是基础性质，帮助用“至少一次命中”解释直觉问题。

## 1.4 条件概率｜ Among Us/狼人杀小剧场

- 教学目标：基于证据更新怀疑概率，区分 `P(A|B)` 与 `P(B|A)`；乘法公式与全概率。
- 玩法：设定好人/内鬼比例与证据真伪率，计算 `P(内鬼|证据)`；支持多个证据组合；强调“证据 ≠ 结论”。

### 设计细节

- 控件：先验比例滑块、证据真阳性/假阳性率、证据数量与独立性开关。
- 计算：用全概率展开分母，严格区分 `P(A|B)` 与 `P(B|A)`；结果卡片展示后验、误判率与混淆矩阵。
- 场景：贴近年轻文化（Among Us/狼人杀）以降低理解门槛；文案可开关“戏剧化台词”。

### 历史介绍

- 条件概率的系统应用由拉普拉斯拓展；贝叶斯定理由托马斯·贝叶斯（1763，后由拉普拉斯推广）提出并发扬。

## 1.4.4 贝叶斯公式｜贝叶斯鉴定台（假阳性陷阱）

- 教学目标：理解先验、似然与后验；揭示假阳性直觉陷阱。
- 玩法：场景可选“外挂检测/粉丝真假/安检/核酸”，设定先验比例与检测误差，展示 `P(真|检出)` 与误判率；分母展开为全概率。

### 设计细节

- 控件：先验比例、灵敏度（真阳性率）、特异度（真阴性率）滑块；结果显示后验与阳性预测值。
- 解释：卡片展示公式分解与直观例子（如低基率下的高误报），支持一键复制公式。

### 历史介绍

- 贝叶斯定理在 18–19 世纪逐步发展，现代广泛应用于统计推断与机器学习；“基率谬误”是经典认知偏差案例。

## 1.4.X 条件概率经典｜ Monty Hall 门牌梗（策略对比）

- 教学目标：信息揭示与条件概率的影响；展示保持/切换策略的成功率差异。
- 玩法：
  - 三门中藏奖品，主持人按规则揭示一扇无奖门；玩家选择“保持”或“切换”。
  - 多次模拟下显示经验成功率与理论值：`P(赢|切换)=2/3`、`P(赢|保持)=1/3`（在标准主持人规则下）。
  - 梗元素：主持人戏剧化台词/特效，门牌贴热门梗标识；一键切换策略并显示对比条形图。
- 规则参数：可选标准规则（主持人总是揭示非奖门且不揭示玩家选择）或非标准规则（用于展示规则变更会改变概率）。
- 公式展示：条件概率与全概率分解；强调“信息揭示改变后验”。

### 设计细节

- 控件：策略选择、轮次、主持人规则开关；统计卡展示各策略长期胜率与标准差。
- 可视化：条形图或折线图对比；动画简洁避免过度干扰。

### 历史介绍

- “蒙提霍尔问题”源自美国电视节目《一锤定音/Let's Make a Deal》；1990 年玛丽莲·沃斯·凡特（Marilyn vos Savant）专栏引发公众讨论，随后大量数学家与统计学家给出严谨解释。

## 1.5 独立性｜独立性探测器（连抽与活动加成）

- 教学目标：判断独立与相关，展示 `P(A∩B)=P(A)P(B)` 成立的条件与反例。
- 玩法：对比“纯独立抽卡”与“活动加成”机制；一键切换“独立/相关”，观察联动。

### 设计细节

- 模型：独立模式下事件序列服从 Bernoulli；相关模式引入“连败加成/活动加成”导致条件概率变化。
- 统计：显示 `P(A∩B)` 与 `P(A)P(B)` 的差异，提示独立性的判定；支持一次性与批量试验。

### 历史介绍

- 独立性概念在 18–19 世纪逐步成熟，现代通过科尔莫哥洛夫公理体系明确化；独立与条件独立是统计推断的核心结构。

---

## 设计系统细节与实现提示

- 架构：每个案例使用独立状态对象（参数、计数、结果），统一初始化与重置接口，减少耦合。
- 渲染：优先 DOM/SVG；需要图表时按页引入 `static/libs/chart/chart.umd.min.js`，避免全局依赖。
- 性能：批量试验采用分帧与节流；动画为低频过渡，移动端降级效果。
- 复现实验：保留伪随机种子接口，便于教学与对照。
- 文案：文化元素（游戏/梗）仅作为载体与命名，确保数学定义与公式准确统一。

## 历史导论（面向第一章）

- 1654：帕斯卡与费马通信奠定概率论基础；1657：惠更斯《赌博问题》早期系统化。
- 1713：伯努利《论猜度术》提出大数定律，说明频率向概率收敛。
- 1763–1812：贝叶斯提出定理、拉普拉斯系统阐述古典概率与贝叶斯思想。
- 1880：约翰·韦恩提出韦恩图，可视化集合关系。
- 1933：科尔莫哥洛夫公理化概率论，建立现代严格基础。

## 页面集成与结构

- `chapter1.html` 为每案例新增容器（`#sec-1-1`~`#sec-1-5`），含标题、简述、公式区、控制面板、结果视图。
- 设计炫酷效果的页面背景，如可以设计动态柏林噪声算法来控制背景的明暗变化，以增强视觉吸引力。
- 设计章节的标题栏，如可以在标题栏添加动态效果，如文字滚动、颜色变化等，以增强视觉吸引力。
- 用 `window.NAV_CONFIG.sectionLinks` 把案例锚点加入导航（参考 `templates/chapter1.html:50-61`）。
- 图形反馈优先 DOM/SVG；需图表时用 `static/libs/chart/chart.umd.min.js`。

## 脚本扩展（`static/js/chapter1.js`）

- 维持 IIFE 与 `DOMContentLoaded` 注册（参考 `static/js/chapter1.js:56-60`），新增：
  - `setupEventAlgebraSandbox()`（1.1）
  - `setupCritChance()`（1.2）
  - `setupGachaLab()`（1.3）
  - `setupAmongUsConditional()`（1.4）
  - `setupBayesLab()`（1.4.4）
  - `setupMontyHall()`（1.4.X）
  - `setupIndependenceProbe()`（1.5）

## 公式与文案

- KaTeX 渲染；每案例提供 2–3 个核心公式与简短前提说明（独立/主持人规则/保底模型等）。
- 梗与文化元素作为正反馈或场景命名，文案可配置（如“欧皇/非酋”）。

## 验证与可维护性

- 自测：边界输入、滑块性能；区分保底与独立模型；Monty Hall 的主持人规则切换对概率的影响。
- E2E 冒烟：锚点存在与无致命控制台错误；不做重型绘图断言。
- 代码一致性：沿用现有风格与模块化，不引入新依赖；功能框为可复用组件。

## 交付内容

- `chapter1.html`：互动区块、控件、公式占位与讲解面板（含视频按钮）。
- `chapter1.js`：初始化函数与基础交互，并在 `DOMContentLoaded` 中调用。
- 每案例 1–2 句使用说明与前提标注（独立/保底/主持人规则等）。

## 可选增强

- Chart.js 折线/条形图；韦恩图运算动画；抽卡结果接入幸运度排位（`localStorage`）。

## 准确性与实现提示（合并你的修改）

- 抽卡保底不是古典等可能模型，表述为“理论概率（给定 p）与频率法对照”；古典法示例放在骰子/均匀样本空间。
- 保底模型给出通用表达（递增或截断几何），避免品牌特定实现不可复用。
- 功能框以组件定义，支持复制与视图切换；三栏布局补充移动端方案与面板切换控件。
