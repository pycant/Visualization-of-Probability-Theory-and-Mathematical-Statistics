「机器学习中的统计学习理论.md」

- 所有「点击展开」都用 `<details>` 标签——这是标准 Markdown 语法，VSCode「Markdown Preview Enhanced」可直接渲染为可点击折叠的网页组件
- 所有代码块都用 ```python 标准格式，可直接在 VSCode Jupyter 内核运行
- 所有可视化（折叠、按钮、滑杆）都用标准 HTML 嵌在 Markdown 内——VSCode 预览可直接交互

`
# 机器学习中的统计学习理论
> VSCode + Jupyter 内核运行，Markdown Preview Enhanced 秒变网页

---

## 1. 示例展示（Example Showcase）

**目标：** 30 秒看懂「贝叶斯 vs 最大似然」谁更靠谱**

**核心交互：** 「垃圾邮件过滤器」双模型对决

功能：
1. 输入任意英文句子 → 实时显示「贝叶斯概率」+「最大似然概率」
2. 一键「训练 1000 封」→ 看两种概率随样本逼近真相
3. 揭示真相：点击「真实标签」→ 显示命中次数 vs 概率校准图
4. 小总结：贝叶斯 = 自带先验，似然 = 只看数据

💡 小提示：把「free」拖到 90 %，贝叶斯概率飙到 95 %——这就是先验的力量！

---

## 2. 理论探索（Theoretical Exploration）

**标题：** 3 步拆解机器学习中的概率——从直觉到公式

---

### 知识点 1/3：最大似然估计（MLE）

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **似然函数**：给定参数 θ 时，观测到样本 X 的概率，记作 L(θ|X)
- **MLE**：选择使 L 最大的 θ，即「最可能产生当前数据的参数」
- **对数似然**：为简化计算取 log，ℓ(θ) = log L(θ|X)
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：写似然  
对于独立样本 {x₁,...,xₙ}  
L(θ) = ∏ᵢ P(xᵢ|θ)

步骤 2：取对数  
ℓ(θ) = Σᵢ log P(xᵢ|θ)

步骤 3：求极值  
dℓ/dθ = 0 → 解出 θ̂_MLE
</details>

#### ② 趣味性可视化
- 滑块调样本量 n → 实时画似然函数峰值，看峰值随 n 变尖
- 点击「加速到 n=1000」→ 峰值变针尖，肉眼验证「一致性」

#### ③ 代码（Jupyter 内核直接跑）
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize

# 1. 生成硬币数据（伯努利试验）
np.random.seed(42)
n = 100
true_p = 0.7
data = np.random.binomial(1, true_p, n)

# 2. 定义对数似然函数（伯努利）
def log_likelihood(p):
    if p <= 0 or p >= 1:
        return -np.inf
    return np.sum(np.log(p * data + (1 - p) * (1 - data)))

# 3. 求极值 → MLE
res = minimize(lambda p: -log_likelihood(p[0]), [0.5], bounds=[(0, 1)])
mle_p = res.x[0]
print(f'MLE 估计 = {mle_p:.3f}')
```

---

### 知识点 2/3：贝叶斯方法 —— 先验 + 似然 = 后验

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **先验 P(θ)**：训练前对参数的 belief
- **似然 P(X|θ)**：给定参数时样本出现概率
- **后验 P(θ|X)**：观测数据后对参数的修正 belief
- **共轭先验**：先验与后验同族，计算简化（如 Beta-Binomial）
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：写贝叶斯定理  
P(θ|X) = P(X|θ)P(θ) / P(X)

步骤 2：取对数  
log P(θ|X) = log P(X|θ) + log P(θ) − log P(X)

步骤 3：极值 → MAP（最大后验）
d/dθ [log P(X|θ) + log P(θ)] = 0
</details>

#### ② 趣味性可视化
- 滑块调先验强度 → 实时看后验峰移动，先验强→峰偏移
- 点击「无限样本」→ 后验 ≈ 似然（先验被淹没）

#### ③ 代码（Jupyter 内核直接跑）
```python
from scipy.stats import beta
import matplotlib.pyplot as plt

# 1. 先验：Beta(α,β) 共轭于二项分布
alpha_prior = 2
beta_prior = 2

# 2. 观测数据
n = 100
k = 70  # 正面次数

# 3. 后验：Beta(α+k, β+n-k)
alpha_post = alpha_prior + k
beta_post = beta_prior + n - k

# 4. 画先验 vs 后验
x = np.linspace(0, 1, 200)
plt.figure(figsize=(6, 4))
plt.plot(x, beta.pdf(x, alpha_prior, beta_prior), label='Prior Beta(2,2)')
plt.plot(x, beta.pdf(x, alpha_post, beta_post), label=f'Posterior Beta({alpha_post},{beta_post})')
plt.axvline(k/n, color='gray', linestyle='--', label='MLE')
plt.legend(); plt.title('Prior vs Posterior')
plt.show()
```

---

### 知识点 3/3：模型校准 —— 概率必须可信

<details>
<summary>📖 专业名词速查（点击展开）</summary>

- **Brier 分数**：(1/N) Σ(p_i − y_i)²，越低越准
- **可靠性曲线**：频率 vs 预测概率的散点图
- **校准**：预测概率 ≈ 长期频率
</details>

#### ① 逐步推导（点击展开）
<details>
<summary>🔍 逐步推导（点击展开）</summary>

步骤 1：收集预测概率 p_i 和真实标签 y_i  
步骤 2：按概率分箱，计算每箱频率  
步骤 3：画可靠性曲线，理想 = 对角线
</details>

#### ② 趣味性可视化
- 一键「重复 1000 次」→ 实时画可靠性曲线，看 70 % 概率≈70 次命中
- 点击「导出 CSV」→ 自己算 Brier

#### ③ 代码（Jupyter 内核直接跑）
```python
from sklearn.calibration import calibration_curve
import matplotlib.pyplot as plt

# 1. 读取模型预测（已在应用部分训练）
probs = np.random.beta(2, 1, 1000)  # 模拟 1000 个概率
y_true = np.random.binomial(1, probs)  # 真实标签按概率生成

# 2. 可靠性曲线
fraction_of_positives, mean_predicted_value = calibration_curve(y_true, probs, n_bins=10)

# 3. 画曲线
plt.figure(figsize=(6, 6))
plt.plot(mean_predicted_value, fraction_of_positives, 'o-', label='Reliability')
plt.plot([0, 1], [0, 1], 'k--', label='Perfect')
plt.xlabel('Predicted Probability'); plt.ylabel('Observed Frequency')
plt.title('Reliability Curve'); plt.legend(); plt.show()
```

---

## 3. 实践应用（Practical Applications）

> 每个应用 =「分步引导 + 核心知识点 + 小测试」  
> 必须逐步点击「已完成」才能解锁下一步；全部完成后弹出「知识点考察」。

---

### 应用一：垃圾邮件过滤器（MLE vs 贝叶斯）

#### 第①步：进入邮箱
功能：
1. 动画：收件箱闪烁「Spam？」→ 用户犹豫是否删除  
2. 核心知识点卡片：「MLE = 只看数据，贝叶斯 = 先验 + 数据」  
3. 点击「我已了解」→ 解锁第②步

#### 第②步：选择模型
功能：
1. 单选按钮：「用 MLE 训练」或「用贝叶斯训练」  
2. 实时显示「先验强度」滑杆（仅贝叶斯可见）  
3. 点击「模型已选定」→ 解锁第③步

#### 第③步：训练模型
功能：
1. 点击「训练 1000 封」→ 进度条跑完，模型保存  
2. 实时显示「训练准确率」与「Brier 分数」  
3. 点击「训练完成」→ 解锁第④步

#### 第④步：实战测试
功能：
1. 输入框输入任意英文句子 → 实时显示两种概率  
2. 点击「真实标签」→ 显示命中 vs 未命中  
3. 对比两种模型的 Brier 分数  
4. 点击「测试完成」→ 弹出「知识点考察」

<!-- === 应用通关网关=== -->
<div class="app-gate" data-app="1">
  <button class="exam-btn">开始知识点考察（3 题）</button>
  <div class="exam-paper" style="display:none;">
    <ol>
      <li>单选：MLE 的核心思想是？
        <br/><label><input type="radio" name="q1" value="A"> A. 最大化先验概率</label>
        <br/><label><input type="radio" name="q1" value="B"> B. 最大化数据出现概率</label>
        <br/><label><input type="radio" name="q1" value="C"> C. 最小化后验概率</label>
      </li>
      <li>判断：先验越强，贝叶斯结果越偏离数据。（√）</li>
      <li>单选：本应用中 Brier 分数越低代表？
        <br/><label><input type="radio" name="q3" value="A"> A. 模型越差</label>
        <br/><label><input type="radio" name="q3" value="B"> B. 模型越好</label>
        <br/><label><input type="radio" name="q3" value="C"> C. 无意义</label>
      </li>
    </ol>
  <button class="submit-exam">提交</button>
  <div class="exam-result" style="display:none;"></div>
</div>
</div>

<script>
/* ========= 应用通关逻辑 ========= */
document.querySelector('.exam-btn').addEventListener('click',e=>{
  document.querySelector('.exam-paper').style.display='block';
});
document.querySelector('.submit-exam').addEventListener('click',e=>{
  const ans=['B','√','B']; // 标准答案
  let score=0;
  ans.forEach((a,i)=>{
    const user=document.querySelector(`input[name="q${i+1}"]:checked`)?.value;
    if(user===a) score++;
  });
  const pass=score>=2; // ≥2 分通关
  document.querySelector('.exam-result').innerHTML=
    `${pass?'✅ 通关':'❌ 未通关'} 得分：${score}/3  
     <button onclick="location.reload()">${pass?'进入下一应用':'重考'}</button>`;
  document.querySelector('.exam-result').style.display='block';
});
</script>

---

## 4. 章节练习（Chapter Exercises）

**Level 1 基础概念**  
功能：  
1. MLE 的核心思想是？（最大化数据出现概率）  
2. 判断：先验越强，贝叶斯结果越偏离数据。（√）  

**Level 2 计算与解读**  
功能：  
1. 给定 30 个观测值，手动计算 MLE 估计值（Logistic 回归）  
2. 若总体方差未知，改用 t 分布再算一次，比较宽度变化  

**Level 3 分析与设计**  
功能：  
1. 设计一个「估计直播间真实在线人数」的抽样方案，说明如何选 n、如何控制成本  
2. 如果总体服从 Cauchy(α=1) 期望无限，给出两条替代估计策略（提示：中位数、截尾均值）  

---

## 5. 网页内容设计概要（UI/UX）

- **顶部：** 标题「机器学习中的统计学习理论」+ 一句 slogan「用概率看懂 AI」  
- **左侧：** 固定导航栏，直接链接到【示例】【理论】【应用】【练习】四个部分  
- **布局：**  
  - 【示例】部分：双滑杆占首屏 70 %，按钮悬浮底部，不打断动画  
  - 【理论】部分：3 张可折叠卡片，每卡右侧留 15 % 宽度给「AI 助手」与「解锁按钮」  
  - 【应用】部分：分步卡片，必须点击「已完成」才能解锁下一步；全部完成后弹出「知识点考察」  
  - 【练习】部分：题目默认折叠，答题后展开解析与知识点回链  
- **视觉：** 主色 #FF6B6B（概率条），辅助灰 #E0E0E0（区间带），所有轨迹默认半透明 0.6  